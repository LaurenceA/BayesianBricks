TODOs:
  Never resampled conditioned variables!
  Include self in self.rvs
  Unify BrRV and Model?

  Dependencies:
    (In)dependencies between variables MUST be encoded by the object graph.
      So, forward can never take external inputs.
      But can have same RV in two different places in tree.
      TransformedRV
    (In)dependencies across variables MUST be encoded by the object graph.

  Automatic parallelisation:
    Choose variables to sample together.
    Dimensions are independent if:
      Independent prior
      Data, and all RV's have the same shape along those dimensions.
      Only pointwise transformations between all RV's and data.
  
  Rename:
    log_prior -> log_prob
  Test:
    independent accept/reject steps
    BrRV
  Metropolis:
    step-size adaptation
    avoid RV log-probability ratios using something like Langevin/single-step HMC
  VI:
    low-rank mass matrix 
  Unify:
    observations and non-reparameterised RV
  Docs



  examples:
    neural firing
    calcium? (Exponential + threshold).
    flips in 
    
    
Gamma priors:
  scale: 
    has Gamma conjugate prior
    equals var/mean, and can thus be viewed as a dispersion parameter.
  mean: 
    resonable to use a Gamma prior
  shape:
    obtain using mean / scale

testing


lapses:
  slow, multiplicative drift

noisy accumulator:
  convolution for speed

diffusion to bound (explicit):
  discretise time
  binary variables (stop/don't stop) for each time-point
    these binary variables are observed (give the reaction time)
    use a fairly sharp sigmoid for the top and bottom
    initialize as a straight line from start point to decision

diffusion to bound (integrated):

kalman filter:
  

discrete confidence (e.g. 1-6)
  parameterise thresholds as:
    discrete distribution over 1-6 (but not equal to the marginal dist. over confidences)
    assume a distriubtion (e.g. Gaussian) over confidences (not equal to the marginal dist)
    back solve for the thresholds 



Data:
  Noisy accumulator:
    Valentin Wyart/Alex Pouget
  Diffusion to bound:
    Roozbeh? Angela Yu?
  Kalman Filter:
    Angela Yu?  
  Confidence:
    Bahador?
